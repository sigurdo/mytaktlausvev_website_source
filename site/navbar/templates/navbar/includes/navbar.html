<nav class="navbar navbar-expand-xl fixed-top navbar-dark bg-primary">
    <div class="container-fluid">
        <a
            class="navbar-brand"
            href="{% if user.is_authenticated %} {% url 'dashboard:dashboard' %} {% else %} {% url 'articles:ArticleDetail' 'om-oss' %} {% endif %}"
        >
            {% load static %}
            <img class="w-16 me-2" src="{% static 'images/logo.svg' %}">
            <span class="d-none d-sm-inline fw-bold">Studentorchesteret Dei Taktlause</span>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsable"
            aria-controls="collapsable" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="collapsable">
            <ul class="navbar-nav me-auto">
                {% load get_navbar_items %}
                {% get_navbar_items as navbar_items %}
                {% for item in navbar_items %}
                    {% if item.is_permitted %}
                        <li class="nav-item dropdown">
                            <a class="
                                nav-link
                                {% if item.is_active %} active {% endif %}
                                {% if item.type == "DROPDOWN" %} dropdown-toggle {% endif %}
                                "
                                href="{% if item.type == "DROPDOWN" %}#{% else %}{{item.link}}{% endif %}"
                                {% if item.type == "DROPDOWN" %}
                                    id="dropdown-button-{{item.pk}}"
                                    role="button"
                                    data-bs-toggle="dropdown"
                                    {% if item.is_active %}
                                        aria-expanded="true"
                                    {% else %}
                                        aria-expanded="false"
                                    {% endif %}
                                {% endif %}>
                                {{item.text}}
                            </a>
                            {% if item.type == "DROPDOWN" %}
                                <ul class="dropdown-menu navbar-dropdown-menu" aria-labelledby="dropdown-button-{{item.pk}}">
                                    {% for sub_item in item.sub_items_annotated %}
                                        {% if sub_item.is_permitted %}
                                            <li class="nav-item">
                                                <a class="
                                                    dropdown-item
                                                    nav-link
                                                    background-color-unset
                                                    {% if sub_item.is_active %}active{% endif %}
                                                    "
                                                    href="{{sub_item.link}}">
                                                    {{sub_item.text}}
                                                </a>
                                            </li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
            <ul class="nav navbar-nav">
                <li class="nav-item">
                    <span class="navbar-text">
                        {% if user.is_authenticated %}
                        <span>Innlogga som <a href="{% url 'accounts:ProfileDetail' user.slug %}">{{user.username}}</a>!</span>
                        <a href="{% url 'logout' %}?next=/">Logg ut</a>
                        {% else %}
                        <span>Du er ikkje innlogga. <a href="{% url 'login' %}">Logg inn</a></span>
                        {% endif %}
                    </span>
                </li>
            </ul>
        </div>
    </div>
</nav>
